ATC_gen = [...
    162.4996  278.1241  371.7754  453.8028  535.3255  616.8475  698.3693  779.8910;
    0.0001    0.0005    0.2653   31.5242   64.1310   96.7394  129.3480  161.9566;
    0.0002   18.7510   81.1838  135.8693  190.2174  244.5652  298.9131  353.2609;
   43.7500  101.5622  148.3878  189.4018  230.1630  270.9239  311.6848  352.4457;
   43.7500  101.5622  148.3878  189.4018  230.1630  270.9239  311.6848  352.4457
   ];

FBMC_gen_1_5 = [...
    162.4995  278.1236  371.7637  453.8039  535.3217  561.8991  552.7109  543.1798;
    0.0001    0.0006    0.2964   31.5221   64.1306   95.7006  126.4849  158.4729;
    0.0003   18.7517   81.1760  135.8697  190.2195  272.1924  372.1977  470.9120;
   43.7500  101.5621  148.3819  189.4022  230.1642  286.7340  353.6535  420.6615;
   43.7500  101.5621  148.3819  189.4022  230.1640  283.4738  344.9529  406.7738
];

FBMC_gen_1_2 = [...
    162.4994  278.1231  371.8750  453.7471  494.8898  500.0000  499.9998  499.9994;
    0.0002    0.0007    0.0000   31.5477   82.5475  119.3559  167.7426  216.1278;
    0.0004   18.7521   81.2500  135.8778  195.6107  282.2573  362.9029  443.5500;
   43.7500  101.5620  148.4375  189.4123  237.4012  299.1933  359.6773  420.1616;
   43.7500  101.5621  148.4375  189.4152  239.5509  299.1935  359.6774  420.1611
];

ALL_gen = [...
    162.4994  278.1231  371.8750  453.7471  494.8898  500.0000  499.9998  499.9994;
    0.0002    0.0007    0.0000   31.5477   82.5475  119.3559  167.7426  216.1278;
    0.0004   18.7521   81.2500  135.8778  195.6107  282.2573  362.9029  443.5500;
   43.7500  101.5620  148.4375  189.4123  237.4012  299.1933  359.6773  420.1616;
   43.7500  101.5621  148.4375  189.4152  239.5509  299.1935  359.6774  420.1611
];

ATC_bus = [...
    88.6352  151.4891  199.8782  248.8230  297.7601  346.6380  395.4701  444.2503;
   73.8645  126.6350  171.8972  204.9798  237.5655  270.2095  302.8992  335.6408;
  -38.6352  -51.4891  -49.8782  -48.8230  -47.7601  -46.6380  -45.4701  -44.2503;
   -5.7218   -1.0185   13.5629   16.1752   18.2324   20.2339   22.1755   24.0409;
    5.6428   28.7415   32.5010   31.4828   30.2549   29.0306   27.7923   26.5297;
   17.9898   37.8511   59.1373   78.3476   97.4042   116.3756  135.2513  154.0140;
   20.1174   34.9696   56.7495   79.5714  102.5039   125.5177  148.6412  171.9020;
  -18.1428  -25.6170  -35.7254  -52.6791  -69.9289  -87.1827 -104.4227 -121.6383;
   13.8674   36.5319   55.1373   68.9733   82.6670   96.4416  110.3260  124.3477
   ];

FBMC_bus_1_5 = [...
    88.6210  151.4212  199.6897  248.0363  290.0863  299.9998  300.0000  300.0000;
   73.8785  126.7023  172.0739  205.7676  245.2329  261.8993  252.7110  243.1798;
  -38.6210  -51.4212  -49.6897  -48.0363  -40.0884    0.0002   50.0000  100.0000;
   -5.7297   -1.0591   13.4468   15.7953   14.5479   29.6083   56.6656   84.0830;
    5.6490   28.7680   32.5811   31.8894   34.2400   57.4160   84.4679  113.1710;
   17.9870   37.8396   59.0988   78.1715   95.5704  114.6263  137.8647  160.2033;
   20.1140   34.9545   56.7020   79.3413  100.3532  114.6916  131.3208  147.2871;
  -18.1489  -25.6438  -35.8172  -53.0850  -73.9122  -87.2082  -85.8616  -85.7357;
   13.8640   36.5165   55.0840   68.7434   80.5173   98.1655  126.2738  154.0609
];

FBMC_bus_1_2 = [...
    88.6504  151.6232  200.7802  258.6137  294.8902  299.9999  299.9999  299.9996;
   73.8490  126.4999  171.0948  195.1336  199.9995  199.9999  199.9999  199.9996;
  -38.6504  -51.6232  -50.7802  -58.6142  -44.8903    0.0000   50.0001  100.0003;
   -5.7130   -0.9365   14.1597   20.8676   23.0867   39.5351   49.6840   62.1231;
    5.6362   28.6882   32.1295   26.3757   32.5858   57.2778   86.7812  118.5734;
   17.9929   37.8758   59.3406   80.6840  101.2383  122.6820  141.6138  160.0410;
   20.1209   34.9979   56.9673   82.3519  103.5771  119.2334  131.2823  141.5473;
  -18.1362  -25.5642  -35.2546  -47.5488  -55.6337  -58.8910  -67.4265  -78.2506;
   13.8709   36.5600   55.4048   71.7669   93.1279  118.4270  140.9597  161.7084
   ];

ALL_bus = [...
    88.6504  151.6232  200.7802  258.6137  294.8902  299.9999  299.9999  299.9996;
   73.8490  126.4999  171.0948  195.1336  199.9995  199.9999  199.9999  199.9996;
  -38.6504  -51.6232  -50.7802  -58.6142  -44.8903    0.0000   50.0001  100.0003;
   -5.7130   -0.9365   14.1597   20.8676   23.0867   39.5351   49.6840   62.1231;
    5.6362   28.6882   32.1295   26.3757   32.5858   57.2778   86.7812  118.5734;
   17.9929   37.8758   59.3406   80.6840  101.2383  122.6820  141.6138  160.0410;
   20.1209   34.9979   56.9673   82.3519  103.5771  119.2334  131.2823  141.5473;
  -18.1362  -25.5642  -35.2546  -47.5488  -55.6337  -58.8910  -67.4265  -78.2506;
   13.8709   36.5600   55.4048   71.7669   93.1279  118.4270  140.9597  161.7084
   ];

ATC_cost = 1.0e+04 * [0.0969    0.2068    0.3268    0.4556    0.5926    0.7377    0.8909    1.0523];

FBMC_cost_1_5 = 1.0e+04 * [0.0969    0.2068    0.3268    0.4556    0.5926    0.7387    0.8979    1.0707];

FBMC_cost_1_2 = 1.0e+04 * [0.0969    0.2068    0.3268    0.4556    0.5931    0.7417    0.9026    1.0756];

ALL_cost = 1.0e+04 * [0.0969    0.2068    0.3268    0.4556    0.5931    0.7417    0.9026    1.0756];

X = [50 100 150 200 250 300 350 400];

Bus_limit = [300 300 300 300 300 300 300 300;
             200 200 200 200 200 200 200 200;
             300 300 300 300 300 300 300 300;
             150 150 150 150 150 150 150 150;
             250 250 250 250 250 250 250 250;
             300 300 300 300 300 300 300 300;
             300 300 300 300 300 300 300 300;
             300 300 300 300 300 300 300 300;
             300 300 300 300 300 300 300 300;
             200 200 200 200 200 200 200 200];
             
for i = 1:1:9
    figure;
    plot(X, ATC_bus(i,:), X, FBMC_bus_1_5(i,:), X, FBMC_bus_1_2(i,:), X, ALL_bus(i,:), X, Bus_limit(i,:),'LineWidth',2.0)
    legend('ATC','FBMC_1_5','FBMC_1_2','ALL','Branch Limit')
end

figure;
plot(X, ATC_cost, X, FBMC_cost_1_5, X, FBMC_cost_1_2, X, ALL_cost,'LineWidth',2.0)
legend('ATC','FBMC_1_5','FBMC_1_2','ALL')